# keiba_model

## 🎯 プロジェクト概要

本プロジェクトは、約 35 年分の JRA レースデータを活用し、期待値（Expected Value）を最大化するベッティング戦略の構築を目的としています。

単なる「的中率」の追求ではなく、市場オッズとの乖離（エッジ）を特定し、長期的な回収率（ROI）を最適化するための機械学習パイプラインを実装しています。

## 🚀 技術的ハイライト

* **多段学習モデル（Stacking）**: LightGBM を用いた 1 段目の勝率予測スコアと、オッズ情報を統合して期待値を推論する 2 段目のメタモデルを組み合わせたスタッキング構成を採用 。

* **確率校正（Calibration）**: Isotonic Regression を導入。モデルが出力する生のスコアを「現実の勝率」へと正しく校正し、期待値計算の信頼性を向上。
* **AI 共創開発**: 生成 AI（ChatGPT）をプロジェクトマネージャー（PM）として定義。仕様策定、進捗管理、リファクタリングを AI と協働して行う高速開発ワークフローを実践。
* **データリーク対策**: 時系列 Split を厳格に適用し、未来の情報が特徴量に混入することを徹底的に排除した実戦的な検証環境を構築 。



## 📝 詳細な思考プロセス

本プロジェクトの背景、具体的な前処理手法、検証結果、および AI との協働記録については、以下の Note に詳細にまとめています。

**[ChatGPTと競馬予測AIをゼロから作った全記録〜1円も儲からなかったけど、学びは最大だった〜](https://note.com/katsuo_1223/n/n8874eaba5725)**

---
